<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgriVision+ - Crop Disease Detector</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css " rel="stylesheet">
    <style>
        :root {
            --primary: #2e7d32;
            --primary-light: #60ad5e;
            --primary-dark: #005005;
            --secondary: #ffd54f;
            --text-dark: #333;
            --text-light: #f5f5f5;
            --background: #f9f9f9;
            --card-bg: #ffffff;
            --border-radius: 8px;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background-color: var(--background);
            color: var(--text-dark);
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        header {
            background-color: var(--primary);
            color: var(--text-light);
            padding: 1rem 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: bold;
        }
        .logo i {
            font-size: 2rem;
        }
        .nav-links {
            display: flex;
            gap: 2rem;
        }
        .nav-links a {
            color: var(--text-light);
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            transition: var(--transition);
        }
        .nav-links a:hover {
            background-color: var(--primary-light);
            transform: translateY(-2px);
        }
        .mobile-menu-btn {
            display: none;
        }

.hero {
    position: relative;
    min-height: 100vh;
    background: linear-gradient(135deg, #0f172a 0%, #1e293b 30%, #0f766e 70%, #22c55e 100%);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 2rem 5%;
    overflow: hidden;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
}

.hero::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
        radial-gradient(circle at 20% 80%, rgba(34, 197, 94, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(59, 130, 246, 0.2) 0%, transparent 50%);
    animation: gradientShift 8s ease-in-out infinite;
    z-index: 1;
}

@keyframes gradientShift {
    0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.8; }
    50% { transform: scale(1.1) rotate(2deg); opacity: 1; }
}

.hero-background {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 2;
}

.floating-leaf {
    position: absolute;
    font-size: 2rem;
    opacity: 0.6;
    animation: floatLeftRight 10s linear infinite;
}

.leaf-1 {
    top: 20%;
    left: -5%;
    animation-duration: 12s;
    animation-delay: 0s;
}

.leaf-2 {
    top: 60%;
    left: -5%;
    animation-duration: 15s;
    animation-delay: 3s;
}

.leaf-3 {
    top: 80%;
    left: -5%;
    animation-duration: 18s;
    animation-delay: 6s;
}

@keyframes floatLeftRight {
    0% { transform: translateX(-100px) translateY(0px) rotate(0deg); }
    25% { transform: translateX(25vw) translateY(-20px) rotate(90deg); }
    50% { transform: translateX(50vw) translateY(10px) rotate(180deg); }
    75% { transform: translateX(75vw) translateY(-10px) rotate(270deg); }
    100% { transform: translateX(100vw) translateY(0px) rotate(360deg); }
}

.ai-scan-circle {
    position: absolute;
    top: 50%;
    right: 10%;
    width: 200px;
    height: 200px;
    border: 3px solid #22c55e;
    border-radius: 50%;
    opacity: 0.7;
    animation: scanPulse 3s infinite, moveCircle 20s linear infinite;
}

@keyframes scanPulse {
    0%, 100% { transform: scale(1); border-color: #22c55e; }
    50% { transform: scale(1.2); border-color: #16a34a; }
}

@keyframes moveCircle {
    0% { transform: translateX(0); }
    50% { transform: translateX(-100px); }
    100% { transform: translateX(0); }
}

.hero-content {
    flex: 1;
    max-width: 600px;
    z-index: 10;
    position: relative;
    animation: slideInLeft 1s ease-out;
}

.hero-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: rgba(34, 197, 94, 0.1);
    border: 1px solid rgba(34, 197, 94, 0.3);
    padding: 0.75rem 1.5rem;
    border-radius: 50px;
    color: #22c55e;
    font-size: 0.9rem;
    font-weight: 600;
    margin-bottom: 2rem;
    backdrop-filter: blur(10px);
    animation: badgePulse 2s infinite;
}

@keyframes badgePulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.4); }
    50% { box-shadow: 0 0 0 10px rgba(34, 197, 94, 0); }
}

.badge-icon {
    animation: bounce 2s infinite;
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-5px); }
    60% { transform: translateY(-3px); }
}

.hero h1 {
    font-size: clamp(3rem, 6vw, 5rem);
    font-weight: 900;
    background: linear-gradient(135deg, #ffffff 0%, #22c55e 50%, #16a34a 100%);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 1.5rem;
    line-height: 1.1;
    letter-spacing: -0.02em;
    animation: textShine 3s ease-in-out infinite;
}

@keyframes textShine {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

.hero p {
    font-size: 1.3rem;
    color: #cbd5e1;
    margin-bottom: 2rem;
    line-height: 1.7;
    max-width: 500px;
}

.hero-stats {
    display: flex;
    gap: 2rem;
    margin-bottom: 2.5rem;
    animation: slideUp 1s ease-out 0.5s both;
}

.stat-item {
    text-align: center;
}

.stat-number {
    display: block;
    font-size: 1.8rem;
    font-weight: 700;
    background: linear-gradient(135deg, #22c55e, #16a34a);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.stat-label {
    color: #94a3b8;
    font-size: 0.9rem;
    font-weight: 500;
}

.hero-cta {
    display: flex;
    gap: 1.5rem;
    animation: slideUp 1s ease-out 0.7s both;
}

.btn-primary {
    position: relative;
    padding: 1.2rem 2.5rem;
    background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
    color: white;
    border: none;
    border-radius: 15px;
    font-weight: 700;
    font-size: 1.1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 10px 30px rgba(34, 197, 94, 0.3);
    overflow: hidden;
}

.btn-shine {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    transition: left 0.6s;
}

.btn-primary:hover .btn-shine {
    left: 100%;
}

.btn-primary:hover {
    transform: translateY(-3px);
    box-shadow: 0 15px 40px rgba(34, 197, 94, 0.4);
}

.btn-secondary {
    padding: 1.2rem 2.5rem;
    background: rgba(255, 255, 255, 0.1);
    color: white;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 15px;
    font-weight: 600;
    font-size: 1.1rem;
    cursor: pointer;
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
}

.btn-secondary:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: translateY(-3px);
    border-color: rgba(255, 255, 255, 0.5);
}

.hero-visual {
    flex: 1;
    position: relative;
    z-index: 10;
    animation: slideInRight 1s ease-out;
}

.disease-cards {
    position: relative;
    height: 500px;
}

.disease-card {
    position: absolute;
    width: 250px;
    padding: 1.5rem;
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 20px;
    color: white;
    transition: all 0.4s ease;
}

.disease-card:hover {
    transform: translateY(-10px) scale(1.05);
    background: rgba(255, 255, 255, 0.12);
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
}

.card-1 {
    top: 0;
    left: 0;
    animation: cardFloat1 6s ease-in-out infinite;
}

.card-2 {
    top: 120px;
    right: 0;
    animation: cardFloat2 6s ease-in-out infinite 2s;
}

.card-3 {
    top: 240px;
    left: 50px;
    animation: cardFloat3 6s ease-in-out infinite 4s;
}

@keyframes cardFloat1 {
    0%, 100% { transform: translateX(0) translateY(0); }
    50% { transform: translateX(30px) translateY(-15px); }
}

@keyframes cardFloat2 {
    0%, 100% { transform: translateX(0) translateY(0); }
    50% { transform: translateX(-25px) translateY(20px); }
}

@keyframes cardFloat3 {
    0%, 100% { transform: translateX(0) translateY(0); }
    50% { transform: translateX(40px) translateY(-25px); }
}

.card-icon {
    font-size: 2.5rem;
    margin-bottom: 1rem;
    display: block;
}

.disease-card h3 {
    font-size: 1.2rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    background: linear-gradient(135deg, #ffffff, #22c55e);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.disease-card p {
    color: #94a3b8;
    font-size: 0.9rem;
    margin: 0;
}

@keyframes slideInLeft {
    from { opacity: 0; transform: translateX(-50px); }
    to { opacity: 1; transform: translateX(0); }
}

@keyframes slideInRight {
    from { opacity: 0; transform: translateX(50px); }
    to { opacity: 1; transform: translateX(0); }
}

@keyframes slideUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
}

@media (max-width: 768px) {
    .hero {
        flex-direction: column;
        text-align: center;
        padding: 2rem;
    }
    
    .hero-stats {
        justify-content: center;
        gap: 1.5rem;
    }
    
    .hero-cta {
        flex-direction: column;
        align-items: center;
    }
    
    .disease-cards {
        height: 300px;
    }
    
    .disease-card {
        width: 200px;
        padding: 1rem;
    }
}

        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }
        .card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 2rem;
            transition: var(--transition);
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        .card h2 {
            color: var(--primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .card p {
            margin-bottom: 1.5rem;
            color: #666;
        }
        .upload-container {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 2rem;
            margin: 2rem 0;
            text-align: center;
        }
        .upload-container h2 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }
        .file-upload {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
        }
        .file-input-wrapper {
            position: relative;
            width: 100%;
            max-width: 400px;
            height: 200px;
            border: 2px dashed var(--primary-light);
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            transition: var(--transition);
            cursor: pointer;
        }
        .file-input-wrapper:hover {
            border-color: var(--primary);
            background-color: rgba(46, 125, 50, 0.05);
        }
        .file-input-wrapper i {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }
        .file-input-text {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .file-preview {
            max-width: 100%;
            max-height: 180px;
            display: none;
        }
        input[type="file"] {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }
        .selected-file-name {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: #666;
        }
        .submit-btn {
            background-color: var(--primary);
            color: var(--text-light);
            border: none;
            padding: 0.8rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        .submit-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .submit-btn:active {
            transform: translateY(0);
        }
        .results {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 2rem;
            margin: 2rem 0;
            text-align: center;
            display: none;
        }
        .results.show {
            display: block;
        }
        .results h3 {
            color: var(--primary);
            margin-bottom: 1rem;
            font-size: 1.6rem;
        }
        .result-card {
            background-color: #f0f8f0;
            border-left: 4px solid var(--primary);
            padding: 1.5rem;
            text-align: left;
            margin-top: 1rem;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }
        .result-title {
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: var(--primary-dark);
        }
        .confidence {
            display: inline-block;
            background-color: var(--secondary);
            padding: 0.3rem 0.6rem;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 0.5rem;
            font-weight: 600;
        }
        .features {
            margin: 4rem 0;
        }
        .section-title {
            text-align: center;
            margin-bottom: 2.5rem;
            color: var(--primary);
        }
        .section-title h2 {
            font-size: 2.2rem;
            margin-bottom: 0.5rem;
        }
        .section-title p {
            color: #666;
            max-width: 700px;
            margin: 0 auto;
        }
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }
        .feature-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            text-align: center;
        }
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        .feature-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }
        .history {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 2rem;
            margin: 2rem 0;
            text-align: center;
        }
        .history h3 {
            color: var(--primary);
            margin-bottom: 1rem;
            font-size: 1.6rem;
        }
        .history table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        .history th, .history td {
            padding: 0.6rem;
            border: 1px solid #ccc;
            text-align: left;
        }
        .history th {
            background-color: var(--primary-light);
            color: var(--text-dark);
        }
        .history tr:hover {
            background-color: #f0f8f0;
        }
        footer {
            background-color: var(--primary-dark);
            color: var(--text-light);
            padding: 3rem 0 1rem 0;
            margin-top: 4rem;
        }
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }
        .footer-column h3 {
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
        }
        .footer-column ul {
            list-style: none;
        }
        .footer-column ul li {
            margin-bottom: 0.8rem;
        }
        .footer-column a {
            color: #ddd;
            text-decoration: none;
            transition: var(--transition);
        }
        .footer-column a:hover {
            text-decoration: underline;
        }
        .copyright {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fadeIn {
            animation: fadeIn 1s ease;
        }
        @media (max-width: 768px) {
            .content {
                grid-template-columns: 1fr;
            }
            .hero h1 {
                font-size: 2.2rem;
            }
            .nav-links {
                display: none;
            }
            .mobile-menu-btn {
                display: block;
                background: none;
                border: none;
                color: var(--text-light);
                font-size: 1.5rem;
                cursor: pointer;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="navbar">
                <div class="logo">
                    <i class="fas fa-leaf"></i>
                    <span>AgriVision+</span>
                </div>
                <div class="nav-links">
                    <a href="#"><i class="fas fa-home"></i> Home</a>
                    <a href="https://en.wikipedia.org/wiki/Plant_disease"><i class="fas fa-microscope"></i> Diseases</a>
                    <a href="#"><i class="fas fa-book"></i> Guide</a>
                    <a href="#"><i class="fas fa-info-circle"></i> About</a>
                    <a href="#"><i class="fas fa-envelope"></i> Contact</a>
                    {% if session_email %}
                        <a href="/signout" style="color: var(--text-light); font-weight: 500;">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </a>
                    {% else %}
                        <a href="/signin" style="color: var(--text-light); font-weight: 500;">
                            <i class="fas fa-sign-in-alt"></i> Login
                        </a>
                    {% endif %}
                </div>
                <button class="mobile-menu-btn">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

   <!-- Hero -->
<section class="hero">
    <div class="hero-background">
        <div class="floating-leaf leaf-1">üå±</div>
        <div class="floating-leaf leaf-2">üçÉ</div>
        <div class="floating-leaf leaf-3">üåø</div>
        <div class="ai-scan-circle"></div>
    </div>
    
    <div class="hero-content">
        <div class="hero-badge">
            <span class="badge-icon">üöÄ</span>
            AI-Powered Agriculture
        </div>
        
        <h1>AgriVision+</h1>
        <p>Identify plant diseases instantly using our AI-powered detection system. Upload a leaf image and get accurate diagnosis within seconds.</p>
        
        <div class="hero-stats">
            <div class="stat-item">
                <span class="stat-number">99.2%</span>
                <span class="stat-label">Accuracy</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">&lt;3s</span>
                <span class="stat-label">Detection</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">24/7</span>
                <span class="stat-label">Available</span>
            </div>
        </div>
        
        <div class="hero-cta">
            <a href="#uploadSection">
    <button class="btn-primary">
        <span>Start Detection</span>
        <div class="btn-shine"></div>
    </button>
</a>

            <button class="btn-secondary">Learn More</button>
        </div>
    </div>
    
    <div class="hero-visual">
        <div class="disease-cards">
            <div class="disease-card card-1">
                <div class="card-icon">üî¨</div>
                <h3>Advanced AI Analysis</h3>
                <p>Deep learning algorithms</p>
            </div>
            <div class="disease-card card-2">
                <div class="card-icon">‚ö°</div>
                <h3>Instant Results</h3>
                <p>Get diagnosis in seconds</p>
            </div>
            <div class="disease-card card-3">
                <div class="card-icon">üéØ</div>
                <h3>Precise Detection</h3>
                <p>99%+ accuracy rate</p>
            </div>
        </div>
    </div>
</section>



    <div class="container">
        <!-- Upload section -->
    <section class="upload-container" id="uploadSection">
            <h2>Upload Leaf Image for Disease Detection</h2>
            <form method="POST" action="/predict" enctype="multipart/form-data" class="file-upload">
                <div class="file-input-wrapper" id="drop-area">
                    <div class="file-input-text">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Drag & drop a leaf image or click to browse</p>
                        <p class="selected-file-name" id="file-name"></p>
                    </div>
                    <img id="image-preview" class="file-preview" src="" alt="Image preview">
                    <input type="file" name="file" id="file-input" accept=".png, .jpg, .jpeg" required>
                </div>
                <button type="submit" class="submit-btn">
                    <i class="fas fa-search"></i> Analyze Image
                </button>
                <button type="button" id="camera-btn" class="submit-btn" style="background-color: var(--primary-light); margin-left: 10px;">
                    <i class="fas fa-camera"></i> Take Photo
                </button>
            </form>

            <!-- Camera Modal -->
            <div id="camera-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.9); z-index: 1000; justify-content: center; align-items: center; flex-direction: column;">
                <div style="background-color: white; padding: 20px; border-radius: var(--border-radius); width: 90%; max-width: 600px; position: relative;">
                    <button id="close-camera" style="position: absolute; top: 10px; right: 10px; background: none; border: none; font-size: 1.5rem; cursor: pointer;">
                        <i class="fas fa-times"></i>
                    </button>
                    <h3 style="margin-bottom: 15px; color: var(--primary);">Take a Photo</h3>
                    <video id="camera-stream" width="100%" height="auto" style="border-radius: var(--border-radius); background-color: #f0f0f0;"></video>
                    <div style="display: flex; justify-content: space-between; margin-top: 15px;">
                        <button id="switch-camera" class="submit-btn" style="background-color: var(--primary-light);">
                            <i class="fas fa-sync"></i> Switch Camera
                        </button>
                        <button id="capture-photo" class="submit-btn">
                            <i class="fas fa-camera"></i> Capture
                        </button>
                    </div>
                    <canvas id="photo-canvas" style="display: none;"></canvas>
                </div>
            </div>
        </section>

        <!-- Results section -->
        <section class="results" id="results-section" {% if prediction %} style="display: block;" {% endif %}>
            <h3>Analysis Results</h3>
            <div class="result-card">
                <div class="result-title">Detected Disease/Status of Crop:</div>
                <span id="prediction-text">
                    {% if prediction %}{{ prediction }}{% else %}No disease detected{% endif %}
                </span>
            </div>

            <!-- Always show Remedy -->
            <div class="result-card" style="margin-top: 1rem;">
                <div class="result-title">Recommended Remedy:</div>
                <p>{{ remedy }}</p>
            </div>

            <!-- Always show Tip -->
            <div class="result-card" style="margin-top: 1rem;">
                <div class="result-title">Care Tip:</div>
                <p>{{ tip }}</p>
            </div>
        </section>

        <!-- Prediction History -->
        <section class="history">
            <h3>Prediction History</h3>
            {% if history and history|length > 0 %}
            <table style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
                <thead>
                    <tr style="background-color: var(--primary-light);">
                        <th style="padding: 0.8rem; text-align: left; border: 1px solid #ccc;">Prediction</th>
                        <th style="padding: 0.8rem; text-align: left; border: 1px solid #ccc;">Remedy</th>
                        <th style="padding: 0.8rem; text-align: left; border: 1px solid #ccc;">Tip</th>
                        <th style="padding: 0.8rem; text-align: left; border: 1px solid #ccc;">Timestamp</th>
                    </tr>
                </thead>
                <tbody>
                    {% for entry in history %}
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 0.6rem; border: 1px solid #ccc;">{{ entry.prediction }}</td>
                        <td style="padding: 0.6rem; border: 1px solid #ccc;">{{ entry.remedy }}</td>
                        <td style="padding: 0.6rem; border: 1px solid #ccc;">{{ entry.tip if entry.tip else "Maintain crop hygiene. Monitor regularly." }}</td>
                        <td style="padding: 0.6rem; border: 1px solid #ccc;">{{ entry.timestamp.strftime('%Y-%m-%d %H:%M') }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <div style="margin-top: 1rem;">
                <a href="/clear_history" class="submit-btn" style="background-color: #d32f2f; text-decoration: none;">
                    <i class="fas fa-trash"></i> Clear History
                </a>
            </div>
            {% else %}
            <p>No prediction history yet.</p>
            {% endif %}
        </section>

        <!-- Features -->
        <section class="features">
            <div class="section-title">
                <h2>Our Features</h2>
                <p>Discover how AgriScan helps farmers and agricultural professionals worldwide</p>
            </div>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-bolt"></i></div>
                    <h3>Instant Detection</h3>
                    <p>Get results within seconds of uploading your image.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-brain"></i></div>
                    <h3>AI-Powered</h3>
                    <p>Trained on thousands of images for high accuracy.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-tablets"></i></div>
                    <h3>Treatment Advice</h3>
                    <p>Customized treatment recommendations to take immediate action.</p>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>AgriVision+</h3>
                    <p>Empowering farmers with AI for early plant disease detection and prevention.</p>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="#">Home</a></li>
                        <li><a href="#">Disease Library</a></li>
                        <li><a href="#">About Us</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Resources</h3>
                    <ul>
                        <li><a href="#">User Guide</a></li>
                        <li><a href="#">FAQ</a></li>
                        <li><a href="#">Blog</a></li>
                        <li><a href="#">Research</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Contact Us</h3>
                    <ul>
                        <li><i class="fas fa-envelope"></i> sagarghp@gmail.com</li>
                        <li><i class="fas fa-phone"></i> +918084615106</li>
                        <li><i class="fas fa-map-marker-alt"></i> ManglaGiri,AndhraPradesh</li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2024 AgriVision+. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // File upload preview functionality
        const fileInput = document.getElementById('file-input');
        const fileNameDisplay = document.getElementById('file-name');
        const imagePreview = document.getElementById('image-preview');
        const dropArea = document.getElementById('drop-area');

        fileInput.addEventListener('change', function () {
            const file = this.files[0];
            if (file) {
                fileNameDisplay.textContent = file.name;
                const reader = new FileReader();
                reader.onload = function (e) {
                    imagePreview.src = e.target.result;
                    imagePreview.style.display = 'block';
                    dropArea.querySelector('.file-input-text').style.display = 'none';
                }
                reader.readAsDataURL(file);
            }
        });

        document.querySelector('form').addEventListener('reset', function () {
            imagePreview.style.display = 'none';
            dropArea.querySelector('.file-input-text').style.display = 'flex';
            fileNameDisplay.textContent = '';
        });

        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, highlight, false);
        });
        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, unhighlight, false);
        });
        function highlight() {
            dropArea.classList.add('highlight');
        }
        function unhighlight() {
            dropArea.classList.remove('highlight');
        }
        dropArea.addEventListener('drop', handleDrop, false);
        function handleDrop(e) {
            fileInput.files = e.dataTransfer.files;
            const event = new Event('change');
            fileInput.dispatchEvent(event);
        }

        // Show results section if there's a prediction
        var hasPrediction = "{{ 'true' if prediction else 'false' }}";
        if (hasPrediction === 'true') {
            document.getElementById('results-section').classList.add('show');
        }

        // Camera functionality
        let stream;
        let facingMode = "environment";
        const cameraBtn = document.getElementById('camera-btn');
        const cameraModal = document.getElementById('camera-modal');
        const closeCamera = document.getElementById('close-camera');
        const cameraStream = document.getElementById('camera-stream');
        const captureBtn = document.getElementById('capture-photo');
        const switchCameraBtn = document.getElementById('switch-camera');
        const photoCanvas = document.getElementById('photo-canvas');

        cameraBtn.addEventListener('click', async () => {
            try {
                stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: facingMode } });
                cameraStream.srcObject = stream;
                cameraStream.play();
                cameraModal.style.display = 'flex';
            } catch (err) {
                alert("Could not access camera. Please allow permissions.");
            }
        });

        closeCamera.addEventListener('click', () => {
            if (stream) stream.getTracks().forEach(track => track.stop());
            cameraModal.style.display = 'none';
        });

        switchCameraBtn.addEventListener('click', async () => {
            if (stream) stream.getTracks().forEach(track => track.stop());
            facingMode = facingMode === "user" ? "environment" : "user";
            try {
                stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: facingMode } });
                cameraStream.srcObject = stream;
                cameraStream.play();
            } catch (err) {
                console.error("Error switching camera:", err);
            }
        });

        captureBtn.addEventListener('click', () => {
            photoCanvas.width = cameraStream.videoWidth;
            photoCanvas.height = cameraStream.videoHeight;
            const context = photoCanvas.getContext('2d');
            context.drawImage(cameraStream, 0, 0, photoCanvas.width, photoCanvas.height);
            photoCanvas.toBlob((blob) => {
                const photoFile = new File([blob], "camera-photo.jpg", { type: "image/jpeg" });
                const dataTransfer = new DataTransfer();
                dataTransfer.items.add(photoFile);
                fileInput.files = dataTransfer.files;
                const event = new Event('change');
                fileInput.dispatchEvent(event);
                if (stream) stream.getTracks().forEach(track => track.stop());
                cameraModal.style.display = 'none';
            }, 'image/jpeg', 0.9);
        });

        cameraModal.addEventListener('click', (e) => {
            if (e.target === cameraModal) {
                if (stream) stream.getTracks().forEach(track => track.stop());
                cameraModal.style.display = 'none';
            }
        });
    </script>
</body>
</html>